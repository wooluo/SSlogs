name: "渗透测试框架检测"
pattern:
  user_agent: "(?i)(metasploit|msfconsole|meterpreter|payload|exploit|shellcode|cobalt|strike|beacon|empire|powershell|empire|covenant|sliver|mythic|poshc2|koadic|pupy|ratty|quasar|njrat|darkcomet|xtreme|cybergate|blackshades|luminosity|link|poison|ivy|gh0st|plugx|shadowpad|winnti|apt|lazarus|fancy|bear|cozy|bear|equation|group|ocean|lotus|panda|kitten|spider|viper|jackal|wolf|fox|dragon|tiger|leopard|lynx|panther|cheetah|lion|jaguar|cougar|bobcat|serval|caracal|ocelot|margay|jaguarundi|kodkod|oncilla|guina|pampas|cat|sand|cat|black|footed|cat|rusty|spotted|cat|flat|headed|cat|fishing|cat|pallas|cat|manul|chinese|mountain|cat|european|wildcat|african|wildcat|jungle|cat|sand|dune|cat)"
  request_path: "(?i).*(shell|cmd|exec|eval|system|proc|fork|spawn|backdoor|webshell|c99|r57|wso|b374k|adminer|phpmyadmin|mysql|postgresql|oracle|mssql|sqlite|mongodb|redis|memcached|elasticsearch|solr|cassandra|couchdb|neo4j|influxdb|grafana|kibana|logstash|beats|prometheus|consul|vault|nomad|terraform|ansible|puppet|chef|saltstack|fabric|capistrano|deploy|jenkins|travis|circleci|github|gitlab|bitbucket|docker|kubernetes|helm|istio|linkerd|envoy|nginx|apache|iis|tomcat|jetty|undertow|netty|vertx|akka|play|spring|struts|hibernate|mybatis|rails|django|flask|bottle|tornado|twisted|gevent|eventlet|asyncio|aiohttp|fastapi|starlette|quart|sanic|falcon|hug|responder|apistar|molten|vibora|japronto|uvloop|hypercorn|gunicorn|uwsgi|mod_wsgi|passenger|puma|unicorn|thin|webrick|mongrel|rack|sinatra|padrino|grape|roda|hanami|dry|rom|sequel|activerecord|datamapper|mongoid|mongoose|eloquent|doctrine|propel|laravel|symfony|zend|cakephp|codeigniter|yii|phalcon|fuel|slim|silex|lumen|express|koa|hapi|fastify|restify|sails|meteor|next|nuxt|gatsby|gridsome|svelte|vue|react|angular|ember|backbone|knockout|underscore|lodash|jquery|prototype|mootools|dojo|extjs|sencha|yui|closure|polymer|lit|stencil|ionic|cordova|phonegap|xamarin|react|native|flutter|ionic|nativescript|expo|capacitor|quasar|onsen|framework7|ratchet|jqm|mobile|semantic|ui|bootstrap|foundation|bulma|materialize|ant|design|element|ui|chakra|ui|mantine|nextui|arco|design|naive|ui|quasar|vuetify|buefy|oruga|vuesax|primevue|devextreme|syncfusion|telerik|kendo|ui|infragistics|ignite|ui|wijmo|ag|grid|handsontable|luckysheet|ethercalc|onlyoffice|collabora|online|nextcloud|owncloud|seafile|pydio|filerun|filebrowser|h5ai|directory|lister|autoindex|fancy|index|indexhibit|gallery|piwigo|coppermine|zenphoto|gallery|project|mybb|phpbb|vbulletin|smf|vanilla|discourse|flarum|nodebb|xenforo|invision|community|suite|wordpress|drupal|joomla|typo3|modx|concrete5|october|cms|grav|craft|cms|statamic|kirby|cms|ghost|hexo|jekyll|hugo|gatsby|gridsome|nuxt|next|docusaurus|vuepress|gitbook)"
severity: "critical"
category: "attack_tool"
description: "检测渗透测试框架、攻击工具和恶意软件活动"
cwe: "CWE-506"
references:
  - "https://attack.mitre.org/techniques/T1059/"
  - "https://attack.mitre.org/techniques/T1210/"
attack_patterns:
  - "渗透测试工具"
  - "恶意载荷投递"
  - "后门植入"
  - "持久化攻击"
response_codes: [200, 404, 403, 401, 500]
threat_level: "critical"
impact: "系统完全入侵，恶意代码执行"